#
#-- SCF Al_nodiis_Kerker -- case=adaptive
#
    keywords: (damping = DFTK.AdaptiveDamping(0.05, 1.0, 0.8, 0.2, 1.1, 0.1), acceleration = DFTK.AndersonAcceleration(0, Any[], Any[], 1.0e6))

hostname        = clustern12

started on      = 2021-07-26T15:07:37.759
julia threads   = 1
BLAS threads    = 1
MPI procs       = 16

temperature     = 0.001
smearing        = DFTK.Smearing.Gaussian()
lattice         = [7.653 0.0 0.0; 0.0 7.653 0.0; 0.0 0.0 15.31]
Ecut            = 20.0
fft_size        = (25, 25, 50)
kgrid           = [7, 7, 4]
kshift          = [0.0, 0.0, 0.0]
n_irreducible_k = 196
n_bands         = 16
n_electr        = 24
type            = potmix
mixing          = KerkerMixing(0.8, 0.0)
damping         = DFTK.AdaptiveDamping(0.05, 1.0, 0.8, 0.2, 1.1, 0.1)
n     Free energy       Eₙ-Eₙ₋₁     ρout-ρin   α      Diag
---   ---------------   ---------   --------   ----   ----
  1   -16.19841499164         NaN   2.34e-01    NaN    2.0
┌ Debug: Iteration 2 linesearch step 1   α=0.8 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.3607455291023989
│   relative_residual = 0.20336303575770776
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.0009527108853164609
│   slope = -0.7940227917892833
│   curv = 0.8588012203794737
│   α_model = 0.9245711032390392
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:139
  2   -16.55916052074   -3.61e-01   1.05e-01   0.80   10.5
┌ Debug: Iteration 3 linesearch step 1   α=1.0 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.0273718756343051
│   relative_residual = 0.019815286889374218
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  3   -16.58653239638   -2.74e-02   3.55e-02   1.00   10.7
┌ Debug: Iteration 4 linesearch step 1   α=1.0 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.0017282679587538041
│   relative_residual = 0.31620454884307175
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  4   -16.58826066433   -1.73e-03   1.14e-02   1.00   10.8
┌ Debug: Iteration 5 linesearch step 1   α=1.0 diagtol=0.0001142182001617497
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.0003769743589607799
│   relative_residual = 0.5279144420588815
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  5   -16.58863763869   -3.77e-04   5.80e-03   1.00   11.7
┌ Debug: Iteration 6 linesearch step 1   α=1.0 diagtol=5.795714952068902e-5
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.00011656913769897415
│   relative_residual = 0.5435473166893809
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  6   -16.58875420783   -1.17e-04   3.18e-03   1.00   12.7
┌ Debug: Iteration 7 linesearch step 1   α=1.0 diagtol=3.175052077128626e-5
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -3.445925055700627e-5
│   relative_residual = 0.5490789939225124
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  7   -16.58878866708   -3.45e-05   1.74e-03   1.00   13.6
┌ Debug: Iteration 8 linesearch step 1   α=1.0 diagtol=1.737358320749214e-5
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -1.0419600851463429e-5
│   relative_residual = 0.54817104583037
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  8   -16.58879908668   -1.04e-05   9.53e-04   1.00   14.4
┌ Debug: Iteration 9 linesearch step 1   α=1.0 diagtol=9.534627379231381e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -3.1289956297086974e-6
│   relative_residual = 0.5486890604426401
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  9   -16.58880221568   -3.13e-06   5.23e-04   1.00   15.2
┌ Debug: Iteration 10 linesearch step 1   α=1.0 diagtol=5.229060628123517e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -9.423875120262437e-7
│   relative_residual = 0.5483518517956604
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 10   -16.58880315807   -9.42e-07   2.87e-04   1.00   16.2
┌ Debug: Iteration 11 linesearch step 1   α=1.0 diagtol=2.868338873055521e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -2.832628105409185e-7
│   relative_residual = 0.5487282224713537
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 11   -16.58880344133   -2.83e-07   1.57e-04   1.00   17.0
┌ Debug: Iteration 12 linesearch step 1   α=1.0 diagtol=1.5732831333386888e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -8.53062900318946e-8
│   relative_residual = 0.5484124222266491
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 12   -16.58880352663   -8.53e-08   8.63e-05   1.00   17.8
┌ Debug: Iteration 13 linesearch step 1   α=1.0 diagtol=8.631246253466559e-7
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -2.5652617807736533e-8
│   relative_residual = 0.548757394846348
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 13   -16.58880355229   -2.57e-08   4.73e-05   1.00   18.8
┌ Debug: Iteration 14 linesearch step 1   α=1.0 diagtol=4.7346929472472557e-7
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -7.725827089188897e-9
│   relative_residual = 0.5484644838949141
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 14   -16.58880356001   -7.73e-09   2.60e-05   1.00   19.7
┌ Debug: Iteration 15 linesearch step 1   α=1.0 diagtol=2.597615858902111e-7
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -2.323609749055322e-9
│   relative_residual = 0.5487527339158043
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 15   -16.58880356234   -2.32e-09   1.43e-05   1.00   20.6
┌ Debug: Iteration 16 linesearch step 1   α=1.0 diagtol=1.4250087001340093e-7
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -6.998206458774803e-10
│   relative_residual = 0.5484712902714659
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 16   -16.58880356304   -7.00e-10   7.82e-06   1.00   21.4
┌ Debug: Iteration 17 linesearch step 1   α=1.0 diagtol=7.818175373047001e-8
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -2.1050183818260848e-10
│   relative_residual = 0.5486906802160887
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 17   -16.58880356325   -2.11e-10   4.29e-06   1.00   22.3
┌ Debug: Iteration 18 linesearch step 1   α=1.0 diagtol=4.288724495800799e-8
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -6.338041202980094e-11
│   relative_residual = 0.5484404266488466
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 18   -16.58880356331   -6.34e-11   2.35e-06   1.00   23.2
┌ Debug: Iteration 19 linesearch step 1   α=1.0 diagtol=2.352754746805938e-8
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -1.9063861600443488e-11
│   relative_residual = 0.5487146753274089
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 19   -16.58880356333   -1.91e-11   1.29e-06   1.00   24.0
┌ Debug: Iteration 20 linesearch step 1   α=1.0 diagtol=1.2906123686761151e-8
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -5.7411853049416095e-12
│   relative_residual = 0.5485408339254518
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 20   -16.58880356333   -5.74e-12   7.08e-07   1.00   24.9

Energy breakdown:
    Kinetic             6.9421307 
    AtomicLocal         2.7102218 
    AtomicNonlocal      3.2005880 
    Ewald               -21.5543405
    PspCorrection       -1.5044666
    Hartree             0.0407542 
    Xc                  -6.4236618
    Entropy             -0.0000292

    total               -16.588803563335

 ──────────────────────────────────────────────────────────────────────────────
                                       Time                   Allocations      
                               ──────────────────────   ───────────────────────
       Tot / % measured:             215s / 100%            29.0GiB / 100%     

 Section               ncalls     time   %tot     avg     alloc   %tot      avg
 ──────────────────────────────────────────────────────────────────────────────
 scf_potential_mixing       1     214s   100%    214s   28.9GiB  100%   28.9GiB
   LOBPCG                 260     206s  96.0%   791ms   27.6GiB  95.5%   109MiB
     Hamiltonian mu...  4.65k    70.7s  33.0%  15.2ms   5.09GiB  17.6%  1.12MiB
       kinetic+local    4.65k    51.4s  24.0%  11.1ms    160MiB  0.54%  35.1KiB
       nonlocal         4.65k    18.3s  8.53%  3.93ms   3.84GiB  13.3%   866KiB
     rayleigh_ritz      4.39k    29.6s  13.8%  6.73ms    685MiB  2.31%   160KiB
     ortho!             18.4k    14.8s  6.91%   806μs    523MiB  1.77%  29.2KiB
   compute_density         20    2.65s  1.24%   133ms    354MiB  1.20%  17.7MiB
   energy_hamiltonian      21    1.87s  0.87%  89.3ms    612MiB  2.07%  29.1MiB
     ene_ops               21    1.78s  0.83%  84.6ms    470MiB  1.59%  22.4MiB
       ene_ops: xc         21    878ms  0.41%  41.8ms    392MiB  1.32%  18.7MiB
       ene_ops: non...     21    676ms  0.32%  32.2ms   14.4MiB  0.05%   703KiB
       ene_ops: kin...     21   91.9ms  0.04%  4.38ms   1.56MiB  0.01%  76.1KiB
       ene_ops: har...     21   28.4ms  0.01%  1.35ms   50.4MiB  0.17%  2.40MiB
       ene_ops: local      21   6.40ms  0.00%   305μs   10.5MiB  0.04%   512KiB
   KerkerMixing            20    451ms  0.21%  22.6ms    113MiB  0.38%  5.67MiB
   apply_kernel             1   50.5ms  0.02%  50.5ms   31.3MiB  0.11%  31.3MiB
   QR orthonormaliz...    260    283μs  0.00%  1.09μs     0.00B  0.00%    0.00B
 ──────────────────────────────────────────────────────────────────────────────
