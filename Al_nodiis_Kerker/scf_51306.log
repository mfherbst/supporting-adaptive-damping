#
#-- SCF Al_nodiis_Kerker -- case=adaptive_05
#
    keywords: (damping = DFTK.AdaptiveDamping(0.125, 1.0, 0.8, 0.5, 1.1, 0.1), acceleration = DFTK.AndersonAcceleration(0, Any[], Any[], 1.0e6))

hostname        = clustern11

started on      = 2021-07-26T15:15:48.312
julia threads   = 1
BLAS threads    = 1
MPI procs       = 16

temperature     = 0.001
smearing        = DFTK.Smearing.Gaussian()
lattice         = [7.653 0.0 0.0; 0.0 7.653 0.0; 0.0 0.0 15.31]
Ecut            = 20.0
fft_size        = (25, 25, 50)
kgrid           = [7, 7, 4]
kshift          = [0.0, 0.0, 0.0]
n_irreducible_k = 196
n_bands         = 16
n_electr        = 24
type            = potmix
mixing          = KerkerMixing(0.8, 0.0)
damping         = DFTK.AdaptiveDamping(0.125, 1.0, 0.8, 0.5, 1.1, 0.1)
n     Free energy       Eₙ-Eₙ₋₁     ρout-ρin   α      Diag
---   ---------------   ---------   --------   ----   ----
  1   -16.19841499164         NaN   2.34e-01    NaN    2.0
┌ Debug: Iteration 2 linesearch step 1   α=0.8 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.36074560426201074
│   relative_residual = 0.20336303534977873
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.0009527082090921186
│   slope = -0.7940226118493579
│   curv = 0.858800532862653
│   α_model = 0.9245716338840989
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:139
  2   -16.55916059590   -3.61e-01   1.05e-01   0.80   10.5
┌ Debug: Iteration 3 linesearch step 1   α=1.0 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.027371836902190694
│   relative_residual = 0.019815229809320094
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  3   -16.58653243280   -2.74e-02   3.55e-02   1.00   10.7
┌ Debug: Iteration 4 linesearch step 1   α=1.0 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.0017282372764846343
│   relative_residual = 0.3162039903611874
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  4   -16.58826067008   -1.73e-03   1.14e-02   1.00   10.8
┌ Debug: Iteration 5 linesearch step 1   α=1.0 diagtol=0.00011421755644545573
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.0003769716665829037
│   relative_residual = 0.5279120057235206
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  5   -16.58863764175   -3.77e-04   5.80e-03   1.00   11.7
┌ Debug: Iteration 6 linesearch step 1   α=1.0 diagtol=5.7956697040944365e-5
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.00011656672812776492
│   relative_residual = 0.5435486705431838
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  6   -16.58875420847   -1.17e-04   3.18e-03   1.00   12.6
┌ Debug: Iteration 7 linesearch step 1   α=1.0 diagtol=3.1750240077487424e-5
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -3.4458093747247176e-5
│   relative_residual = 0.5490909776288119
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  7   -16.58878866657   -3.45e-05   1.74e-03   1.00   13.6
┌ Debug: Iteration 8 linesearch step 1   α=1.0 diagtol=1.7373613964750467e-5
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -1.041965585102389e-5
│   relative_residual = 0.5481899751227522
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  8   -16.58879908622   -1.04e-05   9.53e-04   1.00   14.4
┌ Debug: Iteration 9 linesearch step 1   α=1.0 diagtol=9.534898705085718e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -3.1292975108954124e-6
│   relative_residual = 0.5486927523171364
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  9   -16.58880221552   -3.13e-06   5.23e-04   1.00   15.2
┌ Debug: Iteration 10 linesearch step 1   α=1.0 diagtol=5.229334397806892e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -9.4248705551081e-7
│   relative_residual = 0.5483587663771186
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 10   -16.58880315801   -9.42e-07   2.87e-04   1.00   16.2
┌ Debug: Iteration 11 linesearch step 1   α=1.0 diagtol=2.868517700362666e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -2.833037164862162e-7
│   relative_residual = 0.5487283051049489
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 11   -16.58880344131   -2.83e-07   1.57e-04   1.00   17.0
┌ Debug: Iteration 12 linesearch step 1   α=1.0 diagtol=1.5733932969673185e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -8.53196304717585e-8
│   relative_residual = 0.5483960900435484
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 12   -16.58880352663   -8.53e-08   8.63e-05   1.00   17.9
┌ Debug: Iteration 13 linesearch step 1   α=1.0 diagtol=8.631733795796992e-7
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -2.5655101154598015e-8
│   relative_residual = 0.5487461441606383
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 13   -16.58880355229   -2.57e-08   4.73e-05   1.00   18.8
┌ Debug: Iteration 14 linesearch step 1   α=1.0 diagtol=4.734832501138503e-7
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -7.726029593868589e-9
│   relative_residual = 0.5484662305333976
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 14   -16.58880356001   -7.73e-09   2.60e-05   1.00   19.7
┌ Debug: Iteration 15 linesearch step 1   α=1.0 diagtol=2.5976646262615993e-7
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -2.3236701451878616e-9
│   relative_residual = 0.5487709717432053
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 15   -16.58880356234   -2.32e-09   1.43e-05   1.00   20.6
┌ Debug: Iteration 16 linesearch step 1   α=1.0 diagtol=1.4250589076994156e-7
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -6.999307800015231e-10
│   relative_residual = 0.5484411071911901
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 16   -16.58880356304   -7.00e-10   7.82e-06   1.00   21.4
┌ Debug: Iteration 17 linesearch step 1   α=1.0 diagtol=7.818440168049515e-8
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -2.1050894360996608e-10
│   relative_residual = 0.5486740101136277
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 17   -16.58880356325   -2.11e-10   4.29e-06   1.00   22.3
┌ Debug: Iteration 18 linesearch step 1   α=1.0 diagtol=4.288677855873872e-8
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -6.338041202980094e-11
│   relative_residual = 0.5484564153940966
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 18   -16.58880356331   -6.34e-11   2.35e-06   1.00   23.2
┌ Debug: Iteration 19 linesearch step 1   α=1.0 diagtol=2.352710833997411e-8
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -1.9060308886764687e-11
│   relative_residual = 0.5486820860864846
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 19   -16.58880356333   -1.91e-11   1.29e-06   1.00   24.0
┌ Debug: Iteration 20 linesearch step 1   α=1.0 diagtol=1.2905820919137584e-8
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -5.7340798775840085e-12
│   relative_residual = 0.5485131009411217
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 20   -16.58880356333   -5.73e-12   7.08e-07   1.00   24.9

Energy breakdown:
    Kinetic             6.9421307 
    AtomicLocal         2.7102218 
    AtomicNonlocal      3.2005880 
    Ewald               -21.5543405
    PspCorrection       -1.5044666
    Hartree             0.0407542 
    Xc                  -6.4236618
    Entropy             -0.0000292

    total               -16.588803563335

 ──────────────────────────────────────────────────────────────────────────────
                                       Time                   Allocations      
                               ──────────────────────   ───────────────────────
       Tot / % measured:             269s / 97.1%           35.4GiB / 97.3%    

 Section               ncalls     time   %tot     avg     alloc   %tot      avg
 ──────────────────────────────────────────────────────────────────────────────
 scf_potential_mixing       1     262s   100%    262s   34.4GiB  100%   34.4GiB
   LOBPCG                 260     220s  84.2%   847ms   29.8GiB  86.7%   117MiB
     Hamiltonian mu...  4.65k    70.3s  26.9%  15.1ms   5.29GiB  15.4%  1.16MiB
       kinetic+local    4.65k    50.7s  19.4%  10.9ms    286MiB  0.81%  63.0KiB
       nonlocal         4.65k    18.3s  7.01%  3.94ms   3.88GiB  11.3%   875KiB
     rayleigh_ritz      4.39k    28.5s  10.9%  6.50ms    685MiB  1.94%   160KiB
     ortho!             18.4k    14.4s  5.51%   785μs    523MiB  1.48%  29.2KiB
   energy_hamiltonian      21    14.6s  5.59%   697ms   1.93GiB  5.61%  94.2MiB
     ene_ops               21    12.4s  4.76%   592ms   1.61GiB  4.67%  78.3MiB
       ene_ops: xc         21    5.97s  2.28%   284ms    924MiB  2.62%  44.0MiB
       ene_ops: non...     21    1.14s  0.43%  54.1ms   46.7MiB  0.13%  2.22MiB
       ene_ops: har...     21    513ms  0.20%  24.4ms   75.2MiB  0.21%  3.58MiB
       ene_ops: kin...     21    430ms  0.16%  20.5ms   35.6MiB  0.10%  1.70MiB
       ene_ops: local      21    350ms  0.13%  16.6ms   31.3MiB  0.09%  1.49MiB
   compute_density         20    4.33s  1.66%   217ms    524MiB  1.49%  26.2MiB
   apply_kernel             1    4.13s  1.58%   4.13s    438MiB  1.24%   438MiB
   KerkerMixing            20    455ms  0.17%  22.8ms    114MiB  0.32%  5.72MiB
   QR orthonormaliz...    260    285μs  0.00%  1.10μs     0.00B  0.00%    0.00B
 ──────────────────────────────────────────────────────────────────────────────
┌ Debug: Library handles
│   libGR_handle[] = Ptr{Nothing} @0x000000000c945c70
│   libGR3_handle[] = Ptr{Nothing} @0x000000000eadade0
│   libGRM_handle[] = Ptr{Nothing} @0x00000000071a73c0
└ @ GR /home/herbstm/.julia/packages/GR/4DHy8/src/funcptrs.jl:67
┌ Debug: Found GKS_ENCODING in ENV
│   text_encoding[] = 301
└ @ GR /home/herbstm/.julia/packages/GR/4DHy8/src/GR.jl:468
