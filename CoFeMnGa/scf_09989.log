#
#-- SCF CoFeMnGa -- case=adaptive_05
#
    keywords: (damping = DFTK.AdaptiveDamping(0.125, 1.0, 0.8, 0.5, 1.1, 0.1),)

hostname        = clustern12

started on      = 2021-08-21T21:58:48.397
julia threads   = 1
BLAS threads    = 1
MPI procs       = 16

temperature     = 0.01
smearing        = DFTK.Smearing.Gaussian()
lattice         = [0.0 5.491 5.491; 5.491 0.0 5.491; 5.491 5.491 0.0]
Ecut            = 45.0
fft_size        = (50, 50, 50)
kgrid           = [13, 13, 13]
kshift          = [0.0, 0.0, 0.0]
n_irreducible_k = 280
n_bands         = 62
n_electr        = 51
type            = potmix
mixing          = KerkerMixing(0.8, 0.0)
damping         = DFTK.AdaptiveDamping(0.125, 1.0, 0.8, 0.5, 1.1, 0.1)
n     Free energy       Eₙ-Eₙ₋₁     ρout-ρin   Magnet   α      Diag
---   ---------------   ---------   --------   ------   ----   ----
  1   -326.7919419117         NaN   7.30e+00    3.000    NaN    2.0
┌ Debug: Iteration 2 linesearch step 1   α=0.8 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -13.663398134237468
│   relative_residual = 0.8881652723695919
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model discarded
│   model_relerror = 7.732453146134939
│   slope = -228.63417600227913
│   curv = 198.72611493002225
│   α_model = 1.1504988968500112
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:142
  2   -340.4553400460   -1.37e+01   6.73e+00    1.222   0.80   23.7
┌ Debug: Iteration 3 linesearch step 1   α=0.8 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -26.67005697955176
│   relative_residual = 0.3816479640125614
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model discarded
│   model_relerror = 0.11833918339919196
│   slope = -90.557281110611
│   curv = 133.1864223273967
│   α_model = 0.6799287759829193
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:142
  3   -367.1253970255   -2.67e+01   2.90e+00    0.926   0.80   19.4
┌ Debug: Iteration 4 linesearch step 1   α=0.8 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -3.434965980757511
│   relative_residual = 0.510985956314155
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.015820515361184027
│   slope = -7.940442995450865
│   curv = 8.947017136060857
│   α_model = 0.8874961201814394
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:139
  4   -370.5603630063   -3.43e+00   7.53e-01    2.283   0.80   19.7
┌ Debug: Iteration 5 linesearch step 1   α=0.9762457321995834 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step discarded
│   energy_change = 2.8509350382142884
│   relative_residual = 1.7388547787002113
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.02467346909074757
│   slope = -4.599149209891672
│   curv = 15.55245313195056
│   α_model = 0.29571857062493234
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:139
┌ Debug: Iteration 5 linesearch step 2   α=0.29571857062493234 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.4492609859321419
│   relative_residual = 0.801400537532281
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  5   -371.0096239922   -4.49e-01   4.57e-01    2.436   0.30   39.2
┌ Debug: Iteration 6 linesearch step 1   α=0.5 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step discarded
│   energy_change = 1.5067746193231528
│   relative_residual = 1.6092221375492122
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 4.473867075513509e-7
│   slope = -2.3101650028487244
│   curv = 21.294851573092657
│   α_model = 0.10848467268810451
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:139
┌ Debug: Iteration 6 linesearch step 2   α=0.125 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.12039591270985284
│   relative_residual = 0.9218678715678594
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  6   -371.1300199049   -1.20e-01   1.76e-01    2.617   0.12   39.1
┌ Debug: Iteration 7 linesearch step 1   α=0.5 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step discarded
│   energy_change = 9.692633150840948
│   relative_residual = 3.6820474553863147
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.00494889266616706
│   slope = -10.841233632040446
│   curv = 121.28974214381775
│   α_model = 0.08938293907151351
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:139
┌ Debug: Iteration 7 linesearch step 2   α=0.125 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.4642315202532359
│   relative_residual = 0.4751973518322943
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  7   -371.5942514252   -4.64e-01   3.70e-01    3.076   0.12   39.1
┌ Debug: Iteration 8 linesearch step 1   α=0.5 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step discarded
│   energy_change = 2.6257356172771438
│   relative_residual = 3.9915807209696195
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.0014480412356577142
│   slope = 0.9261913119399574
│   curv = 17.331537078039158
│   α_model = -0.05343965210757545
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:139
┌ Debug: Iteration 8 linesearch step 2   α=-0.125 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step discarded
│   energy_change = 0.00938455167323582
│   relative_residual = 1.2001528951983478
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  8   -371.5848668735    9.38e-03   1.47e-01    3.018  -0.12   39.1
┌ Debug: Iteration 9 linesearch step 1   α=0.5 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step discarded
│   energy_change = 0.5860228802716279
│   relative_residual = 1.6702552909477515
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 5.647720349886894e-5
│   slope = -0.899829873709285
│   curv = 8.287767312478305
│   α_model = 0.10857325498925083
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:139
┌ Debug: Iteration 9 linesearch step 2   α=0.125 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.05346039335142905
│   relative_residual = 0.6941845694733773
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
  9   -371.6383272669   -5.35e-02   1.01e-01    3.049   0.12   38.7
┌ Debug: Iteration 10 linesearch step 1   α=0.5 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.01715810963480635
│   relative_residual = 0.5914155414003285
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.0031862066009687487
│   slope = -0.19367261580899894
│   curv = 0.6369882319000751
│   α_model = 0.3040442603331807
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:139
 10   -371.6554853765   -1.72e-02   1.62e-01    3.031   0.50   19.4
┌ Debug: Iteration 11 linesearch step 1   α=0.5 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.01338964162459888
│   relative_residual = 0.8344438995272863
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 5.1177143128242997e-5
│   slope = -0.03446835412841728
│   curv = 0.030761765465856142
│   α_model = 1.1204933659180014
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:139
 11   -371.6688750181   -1.34e-02   3.01e-02    3.035   0.50   19.4
┌ Debug: Iteration 12 linesearch step 1   α=1.0 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step discarded
│   energy_change = 0.014829759944746002
│   relative_residual = 1.2349780427980337
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.00023089175441620227
│   slope = 0.00899607518328118
│   curv = 0.011660521384272482
│   α_model = -0.7714985365418511
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:139
┌ Debug: Iteration 12 linesearch step 2   α=-0.7714985365418511 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.003127392543319729
│   relative_residual = 0.9483810391652377
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 12   -371.6720024107   -3.13e-03   3.17e-02    3.024  -0.77   38.7
┌ Debug: Iteration 13 linesearch step 1   α=0.7714985365418511 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.0175248133583068
│   relative_residual = 0.5868233552846392
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 1.1448240522341142e-5
│   slope = -0.04808882874612624
│   curv = 0.0657766075232641
│   α_model = 0.7310931736501919
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:139
 13   -371.6895272240   -1.75e-02   9.25e-02    3.039   0.77   19.3
┌ Debug: Iteration 14 linesearch step 1   α=0.8042024910152111 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.004438113756918938
│   relative_residual = 0.7174084379832597
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 4.509290253307629e-5
│   slope = -0.0064286403625855824
│   curv = 0.0022637013337110244
│   α_model = 2.8398800967470024
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:139
 14   -371.6939653378   -4.44e-03   1.49e-02    3.035   0.80   19.4
┌ Debug: Iteration 15 linesearch step 1   α=1.0 diagtol=0.00014851161166214982
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.0037185437996072324
│   relative_residual = 0.5197730711688028
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 15   -371.6976838816   -3.72e-03   5.69e-02    3.022   1.00   20.1
┌ Debug: Iteration 16 linesearch step 1   α=1.0 diagtol=0.00014851161166214982
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.001199515792393413
│   relative_residual = 0.3579741470880612
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 16   -371.6988833974   -1.20e-03   2.09e-02    3.023   1.00   20.1
┌ Debug: Iteration 17 linesearch step 1   α=1.0 diagtol=0.00014851161166214982
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -0.00022353049229195676
│   relative_residual = 0.592041000300647
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 17   -371.6991069279   -2.24e-04   4.09e-02    3.022   1.00   20.1
┌ Debug: Iteration 18 linesearch step 1   α=1.0 diagtol=0.00014851161166214982
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -5.91336604998105e-5
│   relative_residual = 0.1308170619735683
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 18   -371.6991660615   -5.91e-05   5.12e-03    3.020   1.00   20.1
┌ Debug: Iteration 19 linesearch step 1   α=1.0 diagtol=5.1239999246403024e-5
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -1.4570230177923804e-6
│   relative_residual = 1.4811525794498328
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 19   -371.6991675186   -1.46e-06   5.00e-03    3.018   1.00   22.4
┌ Debug: Iteration 20 linesearch step 1   α=1.0 diagtol=4.996519283733737e-5
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -2.4604606210232305e-6
│   relative_residual = 0.11288240970414093
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 20   -371.6991699790   -2.46e-06   1.45e-03    3.018   1.00   22.3
┌ Debug: Iteration 21 linesearch step 1   α=1.0 diagtol=1.4475484289838906e-5
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -8.758183867030311e-8
│   relative_residual = 0.2952286869743546
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 21   -371.6991700666   -8.76e-08   7.68e-04    3.018   1.00   25.0
┌ Debug: Iteration 22 linesearch step 1   α=1.0 diagtol=7.678253774327226e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -4.292985522624804e-9
│   relative_residual = 0.502530869414823
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 22   -371.6991700709   -4.29e-09   1.64e-04    3.018   1.00   26.4
┌ Debug: Iteration 23 linesearch step 1   α=1.0 diagtol=1.6411972736573562e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -8.21330559119815e-10
│   relative_residual = 0.28904160514167954
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 23   -371.6991700717   -8.21e-10   2.89e-05    3.018   1.00   29.8
┌ Debug: Iteration 24 linesearch step 1   α=1.0 diagtol=2.894077056245047e-7
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -8.043343768804334e-11
│   relative_residual = 0.5813608097595068
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 24   -371.6991700718   -8.04e-11   2.28e-05    3.018   1.00   34.1
┌ Debug: Iteration 25 linesearch step 1   α=1.0 diagtol=2.2832966291566048e-7
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -2.4499513529008254e-11
│   relative_residual = 0.10935030471345326
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 25   -371.6991700718   -2.45e-11   1.32e-05    3.018   1.00   34.4
┌ Debug: Iteration 26 linesearch step 1   α=1.0 diagtol=1.3231874914319682e-7
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:293
┌ Debug: Step accepted
│   energy_change = -3.410605131648481e-13
│   relative_residual = 0.5781254308044631
└ @ DFTK /home/herbstm/.julia/packages/DFTK/CsmZm/src/scf/potential_mixing.jl:86
 26   -371.6991700718   -3.41e-13   8.68e-07    3.018   1.00   35.8

Energy breakdown:
    Kinetic             186.9360861
    AtomicLocal         -350.7435516
    AtomicNonlocal      -52.9489156
    Ewald               -237.4603342
    PspCorrection       8.8180340 
    Hartree             113.4097508
    Xc                  -39.7055340
    Entropy             -0.0047056

    total               -371.699170071818

 ──────────────────────────────────────────────────────────────────────────────
                                       Time                   Allocations      
                               ──────────────────────   ───────────────────────
       Tot / % measured:            4323s / 100%             268GiB / 100%     

 Section               ncalls     time   %tot     avg     alloc   %tot      avg
 ──────────────────────────────────────────────────────────────────────────────
 scf_potential_mixing       1    4316s   100%   4316s    267GiB  100%    267GiB
   LOBPCG                 576    4025s  93.3%   6.99s    247GiB  92.5%   438MiB
     Hamiltonian mu...  16.7k    1620s  37.5%  96.9ms   48.0GiB  18.0%  2.94MiB
       kinetic+local    16.7k    1441s  33.4%  86.1ms   1.08GiB  0.41%  67.7KiB
       nonlocal         16.7k     172s  3.99%  10.3ms   31.3GiB  11.7%  1.92MiB
     rayleigh_ritz      16.2k     554s  12.8%  34.3ms   10.4GiB  3.92%   678KiB
     ortho!             69.5k     236s  5.46%  3.39ms   8.88GiB  3.33%   134KiB
   compute_density         32     158s  3.65%   4.92s   3.37GiB  1.26%   108MiB
   energy_hamiltonian      33    33.6s  0.78%   1.02s   8.00GiB  3.00%   248MiB
     ene_ops               33    30.5s  0.71%   923ms   6.65GiB  2.49%   206MiB
       ene_ops: xc         33    14.8s  0.34%   448ms   5.54GiB  2.08%   172MiB
       ene_ops: non...     33    7.94s  0.18%   241ms    134MiB  0.05%  4.07MiB
       ene_ops: kin...     33    1.43s  0.03%  43.3ms   43.5MiB  0.02%  1.32MiB
       ene_ops: har...     33    783ms  0.02%  23.7ms    340MiB  0.12%  10.3MiB
       ene_ops: local      33    385ms  0.01%  11.7ms   84.8MiB  0.03%  2.57MiB
   apply_kernel            13    12.9s  0.30%   990ms   3.72GiB  1.39%   293MiB
   KerkerMixing            32    1.67s  0.04%  52.3ms    911MiB  0.33%  28.5MiB
   QR orthonormaliz...    576    689μs  0.00%  1.20μs     0.00B  0.00%    0.00B
 ──────────────────────────────────────────────────────────────────────────────
