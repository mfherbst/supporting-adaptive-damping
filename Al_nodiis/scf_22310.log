#
#-- SCF Al_nodiis -- case=adaptive_04
#
    keywords: (damping = DFTK.AdaptiveDamping(0.1, 1.0, 0.8, 0.4, 1.1, 0.1), acceleration = DFTK.AndersonAcceleration(0, Any[], Any[], 1.0e6))

hostname        = clustern15

started on      = 2021-07-28T14:17:56.885
julia threads   = 1
BLAS threads    = 1
MPI procs       = 16

temperature     = 0.001
smearing        = DFTK.Smearing.Gaussian()
lattice         = [7.653 0.0 0.0; 0.0 7.653 0.0; 0.0 0.0 15.31]
Ecut            = 20.0
fft_size        = (25, 25, 50)
kgrid           = [7, 7, 4]
kshift          = [0.0, 0.0, 0.0]
n_irreducible_k = 196
n_bands         = 16
n_electr        = 24
type            = potmix
mixing          = SimpleMixing()
damping         = DFTK.AdaptiveDamping(0.1, 1.0, 0.8, 0.4, 1.1, 0.1)
n     Free energy       Eₙ-Eₙ₋₁     ρout-ρin   α      Diag
---   ---------------   ---------   --------   ----   ----
  1   -16.19841499164         NaN   2.34e-01    NaN    2.0
┌ Debug: Iteration 2 linesearch step 1   α=0.8 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = 1.064870435510116
│   relative_residual = 0.35657660823302306
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.00466986227121606
│   slope = -1.5119371969509852
│   curv = 7.123103097941962
│   α_model = 0.21225822175560266
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:139
  2   -15.13354455613    1.06e+00   2.58e-01   0.80   12.6
┌ Debug: Iteration 3 linesearch step 1   α=0.8 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step discarded
│   energy_change = 23.114507465833007
│   relative_residual = 3.450050394588204
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.03025560289429239
│   slope = -18.390003800774203
│   curv = 120.39329332948677
│   α_model = 0.15274940399250725
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:139
┌ Debug: Iteration 3 linesearch step 2   α=0.15274940399250725 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = -1.3906581660119137
│   relative_residual = 0.5028788662577485
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
  3   -16.52420272214   -1.39e+00   2.27e-01   0.15   27.5
┌ Debug: Iteration 4 linesearch step 1   α=0.4 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = 0.16222697079269466
│   relative_residual = 0.8631177899427284
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.003780684437142136
│   slope = -0.8117691626987104
│   curv = 6.079016336105233
│   α_model = 0.13353626932656065
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:139
  4   -16.36197575135    1.62e-01   1.12e-01   0.40   11.3
┌ Debug: Iteration 5 linesearch step 1   α=0.4 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step discarded
│   energy_change = 0.815547743923279
│   relative_residual = 1.66836979308489
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.004661099166960913
│   slope = -3.5247661086033255
│   curv = 27.77066048068487
│   α_model = 0.12692410074491678
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:139
┌ Debug: Iteration 5 linesearch step 2   α=0.12692410074491678 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = -0.22362536111806364
│   relative_residual = 0.5779095427383024
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
  5   -16.58560111247   -2.24e-01   7.47e-02   0.13   22.3
┌ Debug: Iteration 6 linesearch step 1   α=0.4 diagtol=0.0002
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = -0.0019530567251955233
│   relative_residual = 0.6009083720734654
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 8.642033898602876e-5
│   slope = -0.00658324245470944
│   curv = 0.008500893410794819
│   α_model = 0.7744177154779686
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:139
  6   -16.58755416919   -1.95e-03   4.89e-03   0.40   10.7
┌ Debug: Iteration 7 linesearch step 1   α=0.8518594870257655 diagtol=4.8920683220950334e-5
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = 0.0009458662051891054
│   relative_residual = 0.26077128208761086
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.00019059769553466784
│   slope = -0.0034176664243144436
│   curv = 0.010630414019534812
│   α_model = 0.321498900986737
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:139
  7   -16.58660830299    9.46e-04   1.02e-02   0.85   12.9
┌ Debug: Iteration 8 linesearch step 1   α=0.8518594870257655 diagtol=4.8920683220950334e-5
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step discarded
│   energy_change = 0.06590200297622317
│   relative_residual = 4.585662464826008
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.004652806197147223
│   slope = -0.033668642086678406
│   curv = 0.25983444079080625
│   α_model = 0.12957728769214688
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:139
┌ Debug: Iteration 8 linesearch step 2   α=0.12957728769214688 diagtol=4.8920683220950334e-5
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = -0.0021635097249017576
│   relative_residual = 0.49919164966052043
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
  8   -16.58877181271   -2.16e-03   7.10e-03   0.13   25.8
┌ Debug: Iteration 9 linesearch step 1   α=0.4 diagtol=4.8920683220950334e-5
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = -7.63617788734905e-6
│   relative_residual = 0.6136311701885692
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.0009460238339950706
│   slope = -0.00010802296781692071
│   curv = 0.0004445723153887106
│   α_model = 0.24298176939441476
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:139
  9   -16.58877944889   -7.64e-06   9.81e-04   0.40   12.9
┌ Debug: Iteration 10 linesearch step 1   α=0.4 diagtol=9.806832691875522e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = 3.225434265630156e-5
│   relative_residual = 0.7199834349121071
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 1.3344288760527286e-5
│   slope = -0.00022217961369417287
│   curv = 0.001514082731818808
│   α_model = 0.14674205644448324
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:139
 10   -16.58874719455    3.23e-05   1.75e-03   0.40   15.2
┌ Debug: Iteration 11 linesearch step 1   α=0.4 diagtol=9.806832691875522e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step discarded
│   energy_change = 0.00014627055803728695
│   relative_residual = 1.2377413796870729
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.00010649259307661123
│   slope = -0.0007831099753697213
│   curv = 0.005744126561474442
│   α_model = 0.13633229821605938
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:139
┌ Debug: Iteration 11 linesearch step 2   α=0.13633229821605938 diagtol=9.806832691875522e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = -5.338487818207227e-5
│   relative_residual = 0.7043033230345235
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
 11   -16.58880057942   -5.34e-05   1.16e-03   0.14   30.4
┌ Debug: Iteration 12 linesearch step 1   α=0.4 diagtol=9.806832691875522e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = -1.8399109116273848e-6
│   relative_residual = 0.6010381507300107
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.0001540735917054763
│   slope = -5.79706737526924e-6
│   curv = 5.982906956733826e-6
│   α_model = 0.9689382464396473
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:139
 12   -16.58880241933   -1.84e-06   1.23e-04   0.40   15.2
┌ Debug: Iteration 13 linesearch step 1   α=1.0 diagtol=1.230123968349338e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = -4.84058922722852e-7
│   relative_residual = 0.15397484359554628
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
 13   -16.58880290339   -4.84e-07   2.38e-04   1.00   18.3
┌ Debug: Iteration 14 linesearch step 1   α=1.0 diagtol=1.230123968349338e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step discarded
│   energy_change = 2.6269767936071275e-5
│   relative_residual = 6.377926130427972
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 1.3414418835285807e-5
│   slope = -9.733873609406549e-6
│   curv = 7.200657830361069e-5
│   α_model = 0.13518033822360442
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:139
┌ Debug: Iteration 14 linesearch step 2   α=0.13518033822360442 diagtol=1.230123968349338e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = -6.578891955655308e-7
│   relative_residual = 0.07012218029187246
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
 14   -16.58880356128   -6.58e-07   1.29e-04   0.14   36.7
┌ Debug: Iteration 15 linesearch step 1   α=0.4 diagtol=1.230123968349338e-6
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = -1.2657039860641817e-9
│   relative_residual = 0.6301075065972175
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.0003564772191408618
│   slope = -3.949082481883814e-9
│   curv = 3.929733788302148e-9
│   α_model = 1.0049236652211053
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:139
 15   -16.58880356255   -1.27e-09   3.80e-06   0.40   18.3
┌ Debug: Iteration 16 linesearch step 1   α=1.0 diagtol=3.798202762648248e-8
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = -6.919798067883676e-10
│   relative_residual = 0.2747794294783337
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
 16   -16.58880356324   -6.92e-10   5.52e-06   1.00   23.3
┌ Debug: Iteration 17 linesearch step 1   α=1.0 diagtol=3.798202762648248e-8
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step discarded
│   energy_change = 3.508567658627726e-9
│   relative_residual = 6.077076904928162
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 5.062911741297361e-6
│   slope = -1.3218578719685755e-9
│   curv = 9.66088709788765e-9
│   α_model = 0.13682572403289955
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:139
┌ Debug: Iteration 17 linesearch step 2   α=0.13682572403289955 diagtol=3.798202762648248e-8
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = -9.043432669386675e-11
│   relative_residual = 0.27874852653221943
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
 17   -16.58880356333   -9.04e-11   1.52e-06   0.14   46.6
┌ Debug: Iteration 18 linesearch step 1   α=0.4 diagtol=1.521496273666975e-8
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:296
┌ Debug: Step accepted
│   energy_change = -4.263256414560601e-12
│   relative_residual = 0.6274376042429606
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:86
┌ Debug: Quadratic model accepted
│   model_relerror = 0.0
│   slope = -1.4631239307448506e-11
│   curv = 1.9848404275420332e-11
│   α_model = 0.7371494002451066
└ @ DFTK /home/herbstm/.julia/packages/DFTK/L2QMl/src/scf/potential_mixing.jl:139
 18   -16.58880356334   -4.26e-12   3.70e-07   0.40   24.7

Energy breakdown:
    Kinetic             6.9421307 
    AtomicLocal         2.7102218 
    AtomicNonlocal      3.2005880 
    Ewald               -21.5543405
    PspCorrection       -1.5044666
    Hartree             0.0407542 
    Xc                  -6.4236618
    Entropy             -0.0000292

    total               -16.588803563335

 ──────────────────────────────────────────────────────────────────────────────
                                       Time                   Allocations      
                               ──────────────────────   ───────────────────────
       Tot / % measured:             293s / 97.5%           39.3GiB / 97.6%    

 Section               ncalls     time   %tot     avg     alloc   %tot      avg
 ──────────────────────────────────────────────────────────────────────────────
 scf_potential_mixing       1     286s   100%    286s   38.3GiB  100%   38.3GiB
   LOBPCG                 312     242s  84.8%   776ms   33.2GiB  86.5%   109MiB
     Hamiltonian mu...  5.22k    79.2s  27.7%  15.2ms   5.92GiB  15.4%  1.16MiB
       kinetic+local    5.22k    57.2s  20.0%  11.0ms    329MiB  0.84%  64.6KiB
       nonlocal         5.22k    20.4s  7.16%  3.92ms   4.33GiB  11.3%   871KiB
     rayleigh_ritz      4.91k    31.5s  11.0%  6.42ms    755MiB  1.92%   158KiB
     ortho!             20.6k    15.8s  5.55%   770μs    580MiB  1.48%  28.9KiB
   energy_hamiltonian      25    15.5s  5.43%   620ms   2.16GiB  5.64%  88.6MiB
     ene_ops               25    13.3s  4.65%   531ms   1.81GiB  4.73%  74.3MiB
       ene_ops: xc         25    6.15s  2.16%   246ms   0.99GiB  2.57%  40.4MiB
       ene_ops: non...     25    1.25s  0.44%  50.2ms   49.6MiB  0.13%  1.98MiB
       ene_ops: har...     25    547ms  0.19%  21.9ms   86.3MiB  0.22%  3.45MiB
       ene_ops: kin...     25    456ms  0.16%  18.2ms   35.9MiB  0.09%  1.44MiB
       ene_ops: local      25    350ms  0.12%  14.0ms   32.9MiB  0.08%  1.32MiB
   compute_density         24    5.57s  1.95%   232ms    717MiB  1.83%  29.9MiB
   apply_kernel            15    4.83s  1.69%   322ms    889MiB  2.26%  59.2MiB
   QR orthonormaliz...    312    296μs  0.00%   950ns     0.00B  0.00%    0.00B
 ──────────────────────────────────────────────────────────────────────────────
┌ Debug: Library handles
│   libGR_handle[] = Ptr{Nothing} @0x00000000147ca320
│   libGR3_handle[] = Ptr{Nothing} @0x0000000008f5a240
│   libGRM_handle[] = Ptr{Nothing} @0x0000000015901000
└ @ GR /home/herbstm/.julia/packages/GR/4DHy8/src/funcptrs.jl:67
┌ Debug: Found GKS_ENCODING in ENV
│   text_encoding[] = 301
└ @ GR /home/herbstm/.julia/packages/GR/4DHy8/src/GR.jl:468
